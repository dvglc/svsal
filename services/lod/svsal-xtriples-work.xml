<xtriples xml:base="https://id.salamanca.school/">
    <configuration>
        <vocabularies>
            <!-- Input vocabularies -->
            <vocabulary prefix="tei" uri="http://www.tei-c.org/ns/1.0"/>
            <vocabulary prefix="xi" uri="http://www.w3.org/2001/XInclude"/>
            <vocabulary prefix="sal" uri="http://salamanca.adwmainz.de"/>    
            <vocabulary prefix="itei" uri="https://www.salamanca.school/indexed-tei"/>

            <!-- Output vocabularies -->
            <vocabulary prefix="rdf" uri="http://www.w3.org/1999/02/22-rdf-syntax-ns#"/>
            <vocabulary prefix="rdfs" uri="http://www.w3.org/2000/01/rdf-schema#"/>
            <vocabulary prefix="owl" uri="http://www.w3.org/2002/07/owl#"/>        

            <vocabulary prefix="void" uri="http://rdfs.org/ns/void#"/>
            <vocabulary prefix="iiif" uri="http://iiif.io/api/presentation/2.1/"/>
            <vocabulary prefix="foaf" uri="http://xmlns.com/foaf/0.1/"/>            
            <vocabulary prefix="book" uri="http://schema.org/Book/"/>               
            <vocabulary prefix="fabio" uri="http://purl.org/spar/fabio/"/>           
            <vocabulary prefix="cito" uri="http://purl.org/spar/cito/"/>            
            <vocabulary prefix="doco" uri="http://purl.org/spar/doco/"/>            
            <vocabulary prefix="po" uri="http://www.essepuntato.it/2008/12/pattern#"/> 
<!--            <vocabulary prefix="c40" uri="http://purl.org/spar/c4o"/>              -->
<!--            <vocabulary prefix="deo" uri="http://purl.org/spar/deo"/>              -->
<!--            <vocabulary prefix="co" uri="http://purl.org/co/"/>                    -->
        </vocabularies>

        <triples>
            
       <!-- NOTE: in the following, "WXXXX" within @prepend is a placeholder that gets replaced by the actual
            work id through createConfig.xql -->     

<!-- TODO/General:
    - Try to get rid of string() so that values are not isolated from their (indexed) nodes (ML suggestion by Joe Wicentowski)
    - better use union of full xpaths than or'ing predicates/conditions (intersect instead of and'ing, too?)
-->

<!-- TODO refactoring/testing: reset minimum thresholds in @repeat attributes to a higher value in order to catch all resources -->

            <statement n="001">
                <condition>/boolean($currentResource/tei:teiHeader[not(.//tei:relatedItem[@type eq 'completeWork'])])</condition> <!-- produce void.ttl link only once -->
                <subject type="uri"/>
                <predicate prefix="void">inDataset</predicate>
                <object type="uri" prepend="https://api.salamanca.school/v1/">void.ttl#Salamanca</object>
            </statement>
            
            
<!-- ============================================================= -->
<!-- === I. Bibliographic Metadata: Type, Title, Creator, Year === -->  
<!-- ============================================================= -->
            
            <statement n="100"><!-- a fabio:work -->
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="fabio">work</object>
            </statement>
            
            <statement n="101"><!-- fabio:hasTitle -->
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject> <!-- /@work -->
                <predicate prefix="fabio">hasTitle</predicate>
                <object type="literal">/($currentResource/tei:teiHeader/tei:fileDesc/tei:titleStmt/tei:title[@type eq 'main']/text())</object>
            </statement>
            
            <statement n="102"><!-- fabio:has short title -->
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="fabio">hasShortTitle</predicate>
                <object type="literal">/replace($currentResource/tei:teiHeader//tei:titleStmt//tei:title[@type="short"], '"', '\\"')</object>
            </statement>
            
            <statement n="103"><!-- fabio:hasCreator -->
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="fabio">hasCreator</predicate>
                <object type="uri" prepend="authors.">(for $t in $currentResource/tei:teiHeader//tei:titleStmt//tei:author/tei:persName/tokenize(tokenize(@ref, 'author:')[2], ' ')[1] return element t {$t})</object>
            </statement>
            
            <statement n="104"><!-- fabio:has volume count -->
                <condition>/($currentResource/tei:teiHeader//tei:relatedItem[@type eq "work_volume"])</condition>
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="fabio">hasVolumeCount</predicate>
                <object type="literal">/count($currentResource/tei:teiHeader//tei:relatedItem[@type eq "work_volume"])</object>
            </statement>
            
            <statement n="105"><!-- fabio:hasPublicationYear -->
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="fabio">hasPublicationYear</predicate>
                <object type="literal">/($currentResource/tei:teiHeader//tei:sourceDesc//tei:imprint/(tei:date[@type eq 'thisEd'], tei:date[@type eq 'firstEd'])[1]/@when)</object>
            </statement>
            
            <statement n="106"><!-- fabio:has publisher (in cerl) -->
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="fabio">hasPublisher</predicate>
                <object type="uri" prepend="http://thesaurus.cerl.org/record/">/(for $t in $currentResource/tei:teiHeader//tei:sourceDesc//tei:imprint/(tei:publisher[@n='thisEd'], tei:publisher[@n='firstEd'])[1]/tei:persName/tokenize(tokenize(@ref,'cerl:')[2], ' ')[1] return element t {$t})</object>
            </statement>
            
            <statement n="107"><!-- fabio:has publisher (in gnd) -->
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="fabio">hasPublisher</predicate>
                <object type="uri" prepend="http://d-nb.info/gnd/">/(for $t in $currentResource/tei:teiHeader//tei:sourceDesc//tei:imprint/(tei:publisher[@n='thisEd'], tei:publisher[@n='firstEd'])[1]/tei:persName/tokenize(tokenize(@ref,'gnd:')[2],' ')[1] return element t {$t})</object>
            </statement>
            
            <statement n="108"><!-- fabio: has language -->
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="fabio">hasLanguage</predicate>
                <object type="literal">/($currentResource/tei:teiHeader/tei:profileDesc/tei:langUsage/tei:language/text())</object>
            </statement>

            <!-- is the id. URI actually necessary? -->
            <statement n="109"><!-- rdfs:seeAlso SvSal work full id -->
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://id.salamanca.school/texts/">/($currentResource/@docId)</object>
            </statement>
            
            <statement n="110"><!-- rdfs:seeAlso SvSal work webpage (reading view) -->
                <!-- for whole works, we need to build the .html link "directly" (volumes are configured below) -->
                <condition>/boolean(not($currentResource/tei:teiHeader//tei:relatedItem[@type eq "work_multivolume"]))</condition>
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/work.html?wid=">/($currentResource/@docId)</object>
            </statement>
            
            <!-- TODO/Bibliographic:
                - work/volume as part of a (digital) series
                - fabio:has page count
                - deo:dedication
                - book:mentions (organisations)
                - cito:isCitedBy?
                ! test reification of cito:cites in order to associate po:isContainedBy
                ! corresponds to an oclc dataset?
            -->

<!-- =================================================================== -->
<!-- === II. Document Components: Volumes, Sections, Paragraphs etc. === -->
<!-- =================================================================== -->
            
<!-- Todo/Document Components:
    - items and lists, of dictionary entries in particular
-->

    <!-- For each document component, we record
            (1) its type,
            (2) a label, and
            (3) by which other component it is contained
            (4) where to find the html version of it -->
            
            <!-- '[@citetrail]' makes sure that we only capture components that are actually indexed (= have a citetrail) -->
    
            
            <!-- Volume -->

            <statement n="200"> <!-- doco part -->
                <condition>/boolean($currentResource/tei:teiHeader//tei:relatedItem[@type eq "completeWork"])</condition> <!-- if metadata refer to complete work, the current resource must be related to a volume -->
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">part</object>
            </statement>
            
            <statement n="201"> <!-- rdfs label -->
                <condition>/boolean($currentResource/tei:teiHeader//tei:relatedItem[@type eq "completeWork"])</condition>
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/concat('Volume ', $currentResource/tei:teiHeader//tei:sourceDesc/tei:biblStruct/tei:series/tei:biblScope/@n/string())</object>
            </statement>
            
            <statement n="202"> <!-- po isContainedBy -->
                <condition>/boolean($currentResource/tei:teiHeader//tei:relatedItem[@type eq "completeWork"])</condition>
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/">/(substring-after($currentResource/tei:teiHeader//tei:relatedItem[@type eq "completeWork"][1]/@target/string(), 'work:'))</object>
            </statement>
            
            <statement n="203"> <!-- rdfs seeAlso -->
                <condition>/boolean($currentResource[@type eq "work_volume"])</condition>
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[@type eq "work_volume"]/@citetrail/string())</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource[@type eq "work_volume"]/@web/string())</object>
			</statement>
            
            <!-- Frontmatter -->   
            
            <statement n="204"> <!-- doco type -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:front/@citetrail/string())</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">front-matter</object>
            </statement>
            
            <statement n="205"> <!-- rdfs label: multiple volumes -->
                <condition>/boolean($currentResource[self::itei:text and @type eq "work_volume"])</condition>
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:front/@citetrail/string())</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/concat('frontmatter of volume ', $currentResource/@n)</object>
            </statement>
            
            <statement n="206"> <!-- rdfs label: monograph -->
                <condition>/boolean($currentResource[self::itei:text and @type eq "work_monograph"])</condition>
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:front/@citetrail/string())</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">frontmatter</object>
            </statement>
            
            <statement n="207"> <!-- po isContainedBy: multiple volumes -->
                <condition>/boolean($currentResource[self::itei:text and @type eq "work_volume"])</condition>
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:front/@citetrail/string())</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource/itei:front/@citableParent/string())</object>
            </statement>
            
            <statement n="208"> <!-- po isContainedBy: monograph -->
                <condition>/boolean($currentResource[self::itei:text and @type eq "work_monograph"])</condition>
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:front/@citetrail/string())</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/">/($currentResource/@in/string())</object>
            </statement>
            
            <statement n="209"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:front/@citetrail/string())</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="http://www.salamanca.school/">/($currentResource/itei:front/@web/string())</object>
			</statement>
            
            <!-- Backmatter -->
            
            <statement n="210"> <!-- doco type -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:back/@citetrail/string())</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">back-matter</object>
            </statement>
            
            <statement n="211"> <!-- rdfs label: multiple volumes -->
                <condition>/boolean($currentResource[self::itei:text and @type eq "work_volume"])</condition>
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:back/@citetrail/string())</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/concat('backmatter of volume ', $currentResource/@n)</object>
            </statement>
            
            <statement n="212"> <!-- rdfs label: monograph -->
                <condition>/boolean($currentResource[self::itei:text and @type eq "work_monograph"])</condition>
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:back/@citetrail/string())</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">backmatter</object>
            </statement>
            
            <statement n="213"> <!-- po isContainedBy: multiple volumes -->
                <condition>/boolean($currentResource[self::itei:text and @type eq "work_volume"])</condition>
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:back/@citetrail/string())</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource/itei:back/@citableParent/string())</object>
            </statement>
            
            <statement n="214"> <!-- po isContainedBy: monograph -->
                <condition>/boolean($currentResource[self::itei:text and @type eq "work_monograph"])</condition>
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:back/@citetrail/string())</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/">/($currentResource/@in/string())</object>
            </statement>
            
            <statement n="215"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:back/@citetrail/string())</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="http://www.salamanca.school/">/($currentResource/itei:back/@web/string())</object>
			</statement>
 
            <!-- div -->
 
            <statement n="216" repeat="{/min((100020, count($currentResource[self::itei:text]/descendant::itei:div[@citetrail])))}"> <!-- doco type -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]/descendant::itei:div[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">/(if (($currentResource/descendant::itei:div[@citetrail])[$repeatIndex]/@type eq 'book') then 'part' else if (($currentResource/descendant::itei:div[@citetrail])[$repeatIndex]/@type eq 'chapter') then 'chapter' else 'section')</object>
            </statement>
            
            <statement n="217" repeat="{/min((100020, count($currentResource[self::itei:text]/descendant::itei:div[@citetrail])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]/descendant::itei:div[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(($currentResource/descendant::itei:div[@citetrail])[$repeatIndex]/@title/string(), '"', '\\"')</object>
            </statement>
            
            <statement n="218" repeat="{/min((100020, count($currentResource[self::itei:text]/descendant::itei:div[@citetrail])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]/descendant::itei:div[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/">/(if (($currentResource//itei:div[@citetrail])[$repeatIndex]/@citableParent/string()) then concat($currentResource/@in/string(), ':', ($currentResource//itei:div[@citetrail])[$repeatIndex]/@citableParent/string()) else $currentResource/@in/string())</object>
            </statement>
            
            <statement n="219" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:div[@citetrail])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:div[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource//itei:div[@citetrail])[$repeatIndex]/@web</object>
            </statement>
            
            <!-- head -->
            
            <statement n="260"> <!-- doco type -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:head[@citetrail]/@citetrail/string())</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">title</object>
            </statement>
            
            <statement n="261" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:head[@citetrail])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:head[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/normalize-space(replace(($currentResource//itei:head[@citetrail])[$repeatIndex]/string(), '"', '\\"'))</object>
            </statement>
            
            <statement n="262" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:head[@citetrail])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:head[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource//itei:head[@citetrail])[$repeatIndex]/@citableParent/string()</object>
            </statement>
            
            <statement n="263" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:head[@citetrail])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource//itei:head[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource//itei:head[@citetrail])[$repeatIndex]/@web/string()</object>
            </statement>
            
            <!-- p -->
            
            <statement n="220" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:p[@citetrail])))}">
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:p[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">paragraph</object>
            </statement>
            
            <statement n="221" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:p[@citetrail])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:p[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(($currentResource//itei:p[@citetrail])[$repeatIndex]/@title, '"', '\\"')</object>
            </statement>

            <statement n="222" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:p[@citetrail])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:p[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource//itei:p[@citetrail])[$repeatIndex]/@citableParent/string()</object>
            </statement>
            
            <statement n="223" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:p[@citetrail])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:p[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource/descendant::itei:p[@citetrail])[$repeatIndex]/@web</object>
	        </statement>
            
            <!-- signed -->
            
            <statement n="270" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:signed[@citetrail])))}">
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:signed[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">paragraph</object>
            </statement>
            
            <statement n="271" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:signed[@citetrail])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:signed[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(($currentResource//itei:signed[@citetrail])[$repeatIndex]/@title, '"', '\\"')</object>
            </statement>
            
            <statement n="272" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:signed[@citetrail])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:signed[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource//itei:signed[@citetrail])[$repeatIndex]/@citableParent/string()</object>
            </statement>
            
            <statement n="273" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:signed[@citetrail])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:signed[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource/descendant::itei:signed[@citetrail])[$repeatIndex]/@web</object>
            </statement>
            
            <!-- argument -->
            
            <statement n="270" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:argument[@citetrail])))}">
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:argument[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">section</object>
            </statement>
            
            <statement n="271" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:argument[@citetrail])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:argument[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(($currentResource//itei:argument[@citetrail])[$repeatIndex]/@title, '"', '\\"')</object>
            </statement>
            
            <statement n="272" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:argument[@citetrail])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:argument[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource//itei:argument[@citetrail])[$repeatIndex]/@citableParent/string()</object>
            </statement>
            
            <statement n="273" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:argument[@citetrail])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:argument[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource/descendant::itei:argument[@citetrail])[$repeatIndex]/@web</object>
            </statement>
            
            <!-- lg -->
            
            <statement n="280" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:lg[@citetrail])))}">
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:lg[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">paragraph</object> <!-- alternatives: "stanza" -->
            </statement>
            
            <statement n="281" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:lg[@citetrail])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:lg[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(($currentResource//itei:lg[@citetrail])[$repeatIndex]/@title, '"', '\\"')</object>
            </statement>
            
            <statement n="282" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:lg[@citetrail])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:lg[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource//itei:lg[@citetrail])[$repeatIndex]/@citableParent/string()</object>
            </statement>
            
            <statement n="283" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:lg[@citetrail])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:lg[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource/descendant::itei:lg[@citetrail])[$repeatIndex]/@web</object>
            </statement>
            
            <!-- table -->
            
            <statement n="280" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:table[@citetrail])))}">
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:table[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">table</object>
            </statement>
            
            <statement n="281" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:table[@citetrail])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:table[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(($currentResource//itei:table[@citetrail])[$repeatIndex]/@title, '"', '\\"')</object>
            </statement>
            
            <statement n="282" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:table[@citetrail])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:table[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource//itei:table[@citetrail])[$repeatIndex]/@citableParent/string()</object>
            </statement>
            
            <statement n="283" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:table[@citetrail])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:table[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource/descendant::itei:table[@citetrail])[$repeatIndex]/@web</object>
            </statement>
            
            <!-- titlePage -->
            
            <statement n="224"> <!-- fabio page -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:titlePage[@citetrail]/@citetrail/string())</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="fabio">page</object>
            </statement>
            
            <statement n="225" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:titlePage[@citetrail])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:titlePage[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/(if (starts-with($currentResource/@citetrail/string(), 'vol')) then ("Title page of volume " || replace((tokenize($currentResource/@citetrail/string(), '.'))[1], 'vol', '')) else "Title page")</object>
            </statement>
            
            <statement n="226" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:titlePage[@citetrail])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:titlePage[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/">/(if (($currentResource//itei:titlePage[@citetrail])[$repeatIndex]/@citableParent/string()) then concat($currentResource/@in/string(), ':', ($currentResource//itei:titlePage[@citetrail])[$repeatIndex]/@citableParent/string()) else $currentResource/@in/string())</object>
            </statement>
            
            <statement n="227" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:titlePage[@citetrail])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:titlePage[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource//itei:titlePage[@citetrail])[$repeatIndex]/@web/string()</object>
            </statement>
            
            <!-- titlePart -->

            <statement n="228"> <!-- doco type -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:titlePart[@citetrail]/@citetrail/string())</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">title</object>
            </statement>
            
            <statement n="229" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:titlePart[@citetrail])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:titlePart[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/normalize-space(replace(($currentResource//itei:titlePart[@citetrail])[$repeatIndex]/string(), '"', '\\"'))</object>
            </statement>
            
            <statement n="230" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:titlePart[@citetrail])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:titlePart[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource//itei:titlePart[@citetrail])[$repeatIndex]/@citableParent/string()</object>
            </statement>
            
            <statement n="231" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:titlePart[@citetrail])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource//itei:titlePart[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource//itei:titlePart[@citetrail])[$repeatIndex]/@web/string()</object>
            </statement>
            
            <!-- milestones -->
            
            <statement n="232"> <!-- doco type -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:milestone[@citetrail]/@citetrail/string())</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">section</object>
            </statement>
            
            <statement n="233" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:milestone[@citetrail])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:milestone[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(($currentResource//itei:milestone[@citetrail])[$repeatIndex]/@title/string(), '"', '\\"')</object>
            </statement>
            
            <statement n="234" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:milestone[@citetrail])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:milestone[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource//itei:milestone[@citetrail])[$repeatIndex]/@citableParent/string()</object>
            </statement>
            
            <statement n="235" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:milestone[@citetrail])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:milestone[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource//itei:milestone[@citetrail])[$repeatIndex]/@web/string()</object>
			 </statement>
            
            <!-- list -->
       
            <statement n="236"> <!-- doco type -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:list[@citetrail]/@citetrail/string())</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">list</object>
            </statement>
            
            <statement n="237" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:list[@citetrail])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:list[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(($currentResource//itei:list[@citetrail])[$repeatIndex]/@title/string(), '"', '\\"')</object>
            </statement>
            
            <statement n="238" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:list[@citetrail])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:list[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/">/(if (($currentResource//itei:list[@citetrail])[$repeatIndex]/@citableParent/string()) then concat($currentResource/@in/string(), ':', ($currentResource//itei:list[@citetrail])[$repeatIndex]/@citableParent/string()) else $currentResource/@in/string())</object>
            </statement>
            
            <statement n="239" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:list[@citetrail])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:list[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource//itei:list[@citetrail])[$repeatIndex]/@web/string()</object>
			</statement>
            
            <!-- item -->
            
            <statement n="240"> <!-- doco type -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:item[@citetrail]/@citetrail/string())</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">section</object>
            </statement>
            
            <statement n="241" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:item[@citetrail])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:item[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(($currentResource//itei:item[@citetrail])[$repeatIndex]/@title/string(), '"', '\\"')</object>
            </statement>
            
            <statement n="242" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:item[@citetrail])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:item[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/">/(if (($currentResource//itei:item[@citetrail])[$repeatIndex]/@citableParent/string()) then concat($currentResource/@in/string(), ':', ($currentResource//itei:item[@citetrail])[$repeatIndex]/@citableParent/string()) else $currentResource/@in/string())</object>
            </statement>
            
            <statement n="243" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:item[@citetrail])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:item[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource//itei:item[@citetrail])[$repeatIndex]/@web/string()</object>
			</statement>
            
            <!-- notes -->
            
            <statement n="244"> <!-- doco type -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:note[@citetrail]/@citetrail/string())</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">footnote</object>
            </statement>
            
            <statement n="245" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:note[@citetrail])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:note[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(($currentResource//itei:note[@citetrail])[$repeatIndex]/@title/string(), '"', '\\"')</object>
            </statement>
            
            <statement n="246" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:note[@citetrail])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:note[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource//itei:note[@citetrail])[$repeatIndex]/@citableParent/string()</object>
            </statement>
            
            <statement n="247" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:note[@citetrail])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:note[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource//itei:note[@citetrail])[$repeatIndex]/@web/string()</object>
			</statement>
            
            <!-- label (all - should we differentiate further wrt @place? ) -->
            
            <statement n="248"> <!-- doco type -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:label[@citetrail]/@citetrail/string())</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">label</object>
            </statement>
            
            <statement n="249" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:label[@citetrail])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:label[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(($currentResource//itei:label[@citetrail])[$repeatIndex]/@title/string(), '"', '\\"')</object>
            </statement>
            
            <statement n="250" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:label[@citetrail])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:label[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource//itei:label[@citetrail])[$repeatIndex]/@citableParent/string()</object>
            </statement>
            
            <statement n="251" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:label[@citetrail])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:label[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource//itei:label[@citetrail])[$repeatIndex]/@web/string()</object>
			 </statement>
       

<!-- ==================================== -->
<!-- === III. Physical Aspects: Pages === -->
<!-- ==================================== -->
            
            <!-- pages -->
            
            <statement n="300">
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:pb[@citetrail]/@citetrail/string())</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="fabio">page</object>
            </statement>
            
            <statement n="301" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:pb[@citetrail])))}">
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:pb[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(normalize-space(($currentResource//itei:pb[@citetrail])[$repeatIndex]/@title/string()), '"', '\\"')</object>
            </statement>

            <statement n="302" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:pb[@citetrail])))}">
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:pb[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/">/('abcdefg')</object>
                <!-- /(if (($currentResource//itei:pb[@citetrail])[$repeatIndex]/@citableParent/string() ne '') then concat($currentResource/@in/string(), ':', ($currentResource//itei:pb[@citetrail])[$repeatIndex]/@citableParent/string()) else $currentResource/@in/string()) -->
            </statement>
            
            <statement n="303" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:pb[@citetrail])))}">
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:pb[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://facs.salamanca.school/iiif/image/">/concat(
                    if (matches(($currentResource[self::itei:text]//itei:pb[@citetrail])[$repeatIndex]/@facs, '^facs:W\d{4}-\d{4}$')) then 
                        replace(($currentResource[self::itei:text]//itei:pb[@citetrail])[$repeatIndex]/@facs, '^facs:((W\d{4})-\d{4})$', '$2!$1')
                    else if (matches(($currentResource[self::itei:text]//itei:pb[@citetrail])[$repeatIndex]/@facs, '^facs:W\d{4}-[A-z]-\d{4}$')) then 
                        replace(($currentResource[self::itei:text]//itei:pb[@citetrail])[$repeatIndex]/@facs, '^facs:((W\d{4})-([A-z])-\d{4})$', '$2!$3!$1')
                    else error(),
                    '/full/full/0/default.jpg')
                </object> <!-- referring to *iiif* image (jpg) -->
	        </statement> 
            
            <statement n="304" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:pb[@citetrail])))}">
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:pb[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource//itei:pb[@citetrail])[$repeatIndex]/@web/string()</object>
	        </statement>

            <!-- iiif -->
            
            <statement n="305" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:pb[@citetrail])))}">
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:pb[@citetrail])[$repeatIndex]/@citetrail/string()</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="iiif">canvas</object>
            </statement>
            
            <!-- TODO/iiif:
                - Other iiif stuff: label, height, width, thumbnail, otherContent, startCanvas (per work, not per page)
                - blank node for image resource
                - blank node for annotation mentioning image resource
                - iiif:images contains annotations
            -->


<!-- ====================== -->
<!-- === IV. References === -->
<!-- ====================== -->

<!-- TODO/References:
    - render persons who are mentioned, but not cited as authors
    - cito:Citation instead of cito:CitationAct (deprecated?)
-->
            
             <!-- a. References within citations (<cit>): We render this with cito:includesQuotationFrom -->
            
             <!-- a.1. ... to work titles (-> CitationAct_a_XY-## blank nodes) -->
            
             <!-- SvSal works -->
            
    		 <statement n="401" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'work:')])))}"><!-- a CitationAct event... -->
    			<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-works-', $repeatIndex)</subject>
    			<predicate prefix="rdf">type</predicate>
    			<object type="uri" prefix="cito">citationAct</object>
    		 </statement>
            
			 <statement n="402" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'work:')])))}"><!-- ... of type... -->
				<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-works-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitationCharacterization</predicate>
				<object type="uri" prefix="cito">includesQuotationFrom</object>
			 </statement>
            
			 <statement n="403" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'work:')])))}"><!-- ... what is cited? -->
				<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-works-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitedEntity</predicate>
				<object type="uri" prepend="texts/">/($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'work:')])[$repeatIndex]/tokenize(tokenize(@ref, 'work:')[2], ' ')[1]</object>
			 </statement>
            
			 <statement n="404" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'work:')])))}"><!-- ... where is the citation? -->
				<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-works-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
		        <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'work:')])[$repeatIndex]/ancestor::itei:*[@citetrail][1]/@citetrail/string())</object>
			 </statement>
            
             <!-- OCLC works -->
            
			 <statement n="405" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'oclc:')])))}"><!-- a CitationAct event... -->
    			<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-oclc-', $repeatIndex)</subject>
    			<predicate prefix="rdf">type</predicate>
    			<object type="uri" prefix="cito">citationAct</object>
    		 </statement>
            
			 <statement n="406" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'oclc:')])))}"><!-- ... of type... -->
				<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-oclc-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitationCharacterization</predicate>
				<object type="uri" prefix="cito">includesQuotationFrom</object>
			 </statement>
            
			 <statement n="407" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'oclc:')])))}"><!-- ... what is cited? -->
				<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-oclc-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitedEntity</predicate>
				<object type="uri" prepend="http://www.worldcat.org/oclc/">/($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'oclc:')])[$repeatIndex]/tokenize(tokenize(@ref, 'oclc:')[2], ' ')[1]</object>
			 </statement>
            
			 <statement n="408" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'oclc:')])))}"><!-- ... where is the citation? -->
				<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-oclc-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
		        <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'oclc:')])[$repeatIndex]/ancestor::itei:*[@citetrail][1]/@citetrail/string())</object>
			 </statement>
            
             <!-- GND works -->
            
			 <statement n="409" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'gnd:')])))}"><!-- a CitationAct event... -->
    			<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
    			<predicate prefix="rdf">type</predicate>
    			<object type="uri" prefix="cito">citationAct</object>
    		 </statement>
            
			 <statement n="410" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'gnd:')])))}"><!-- ... of type... -->
				<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitationCharacterization</predicate>
				<object type="uri" prefix="cito">includesQuotationFrom</object>
			 </statement>
            
			 <statement n="411" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'gnd:')])))}"><!-- ... what is cited? -->
				<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitedEntity</predicate>
				<object type="uri" prepend="http://d-nb.info/gnd/">/($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'gnd:')])[$repeatIndex]/tokenize(tokenize(@ref, 'gnd:')[2], ' ')[1]</object>
			 </statement>
            
			 <statement n="412" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'gnd:')])))}"><!-- ... where is the citation? -->
				<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
		        <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'gnd:')])[$repeatIndex]/ancestor::itei:*[@citetrail][1]/@citetrail/string())</object>
			 </statement>
            
             <!-- a.2. ... to authors (CitationAct_b_XY-## blank nodes) -->
            
            <!-- SvSal authors -->
            
            <statement n="413" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'author:')])))}"> <!-- cito citationAct -->
            	<subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-authors-', $repeatIndex)</subject>
            	<predicate prefix="rdf">type</predicate>
            	<object type="uri" prefix="cito">citationAct</object>
            </statement>
            
            <statement n="414" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'author:')])))}"><!-- ... of type ... -->
            	<subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-authors-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitationCharacterization</predicate>
            	<object type="uri" prefix="cito">citesAsRelated</object>
            </statement>
            
            <statement n="415" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'author:')])))}"> <!-- ... what is cited? -->
            	<subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-authors-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitedEntity</predicate>
            	<object type="uri" prepend="authors.">/($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'author:')])[$repeatIndex]/tokenize(tokenize(@ref, 'author:')[2], ' ')[1]</object>
            </statement>
            
            <statement n="416" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'author:')])))}"><!-- ... where is the citation? -->
                <subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-authors-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
                <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'author:')])[$repeatIndex]/ancestor::itei:*[@citetrail][1]/@citetrail/string())</object>
            </statement> <!-- choose only p or div as ancestors here? .../ancestor::*[self::itei:p or self::itei:div][1]/... -->
            
            <!-- Cerl authors -->
            
            <statement n="417" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'cerl:')])))}"><!-- a CitationAct event... -->
            	<subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-cerl-', $repeatIndex)</subject>
            	<predicate prefix="rdf">type</predicate>
            	<object type="uri" prefix="cito">citationAct</object>
            </statement>
            
            <statement n="418" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'cerl:')])))}"><!-- ... of type... -->
            	<subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-cerl-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitationCharacterization</predicate>
            	<object type="uri" prefix="cito">citesAsRelated</object>
            </statement>
            
            <statement n="419" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'cerl:')])))}"><!-- ... what is cited? -->
            	<subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-cerl-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitedEntity</predicate>
            	<object type="uri" prepend="http://thesaurus.cerl.org/record/">/($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'cerl:')])[$repeatIndex]/tokenize(tokenize(@ref, 'cerl:')[2], ' ')[1]</object>
            </statement>
            
            <statement n="420" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'cerl:')])))}"><!-- ... where is the citation? -->
            	<subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-cerl-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
                <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'cerl:')])[$repeatIndex]/ancestor::itei:*[@citetrail][1]/@citetrail/string())</object>
            </statement> <!-- choose only p or div as ancestors here? .../ancestor::*[self::itei:p or self::itei:div][1]/... -->
            
            <!-- GND authors -->
            
            <statement n="421" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'gnd:')])))}"><!-- a CitationAct event... -->
            	<subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
            	<predicate prefix="rdf">type</predicate>
            	<object type="uri" prefix="cito">citationAct</object>
            </statement>
            
            <statement n="422" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'gnd:')])))}"><!-- ... of type... -->
            	<subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitationCharacterization</predicate>
            	<object type="uri" prefix="cito">citesAsRelated</object>
            </statement>
            
            <statement n="423" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'gnd:')])))}"><!-- ... what is cited? -->
            	<subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitedEntity</predicate>
                <object type="uri" prepend="http://d-nb.info/gnd/">/($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'gnd:')])[$repeatIndex]/tokenize(tokenize(@ref, 'gnd:')[2], ' ')[1]</object>
            </statement>
            
            <statement n="424" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'gnd:')])))}"><!-- ... where is the citation? -->
            	<subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
                <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'gnd:')])[$repeatIndex]/ancestor::itei:*[@citetrail][1]/@citetrail/string())</object>
            </statement> <!-- choose only p or div as ancestors here? .../ancestor::*[self::itei:p or self::itei:div][1]/... -->
            
            
             <!-- b. References outside of citations: We render this with cito:citesAsRelated -->

             <!-- b.1. ... to work titles (-> CitationAct_c_XY-## blank nodes) -->
            
             <!-- SvSal works -->
            
    		 <statement n="425" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'work:')][not(ancestor::itei:cit)])))}"><!-- a CitationAct event... -->
    			<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-works-', $repeatIndex)</subject>
    			<predicate prefix="rdf">type</predicate>
    			<object type="uri" prefix="cito">citationAct</object>
    		 </statement>
            
			 <statement n="426" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'work:')][not(ancestor::itei:cit)])))}"><!-- ... of type... -->
				<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-works-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitationCharacterization</predicate>
				<object type="uri" prefix="cito">citesAsRelated</object>
			 </statement>
            
			 <statement n="427" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'work:')][not(ancestor::itei:cit)])))}"><!-- ... what is cited? -->
				<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-works-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitedEntity</predicate>
				<object type="uri" prepend="texts/">/($currentResource[self::itei:text]//itei:title[contains(@ref, 'work:')][not(ancestor::itei:cit)])[$repeatIndex]/tokenize(tokenize(@ref, 'work:')[2], ' ')[1]</object>
			 </statement>
            
			 <statement n="428" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'work:')][not(ancestor::itei:cit)])))}"><!-- ... where is the citation? -->
				<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-works-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
		        <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:title[contains(@ref, 'work:')][not(ancestor::itei:cit)])[$repeatIndex]/ancestor::itei:*[@citetrail][1]/@citetrail/string())</object>
			 </statement>
            
             <!-- OCLC works -->
            
			 <statement n="429" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'oclc:')][not(ancestor::itei:cit)])))}"><!-- a CitationAct event... -->
    			<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-oclc-', $repeatIndex)</subject>
    			<predicate prefix="rdf">type</predicate>
    			<object type="uri" prefix="cito">citationAct</object>
    		 </statement>
            
			 <statement n="430" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'oclc:')][not(ancestor::itei:cit)])))}"><!-- ... of type... -->
				<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-oclc-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitationCharacterization</predicate>
				<object type="uri" prefix="cito">citesAsRelated</object>
			 </statement>
            
			 <statement n="431" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'oclc:')][not(ancestor::itei:cit)])))}"><!-- ... what is cited? -->
				<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-oclc-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitedEntity</predicate>
				<object type="uri" prepend="http://www.worldcat.org/oclc/">/($currentResource[self::itei:text]//itei:title[contains(@ref, 'oclc:')][not(ancestor::itei:cit)])[$repeatIndex]/tokenize(tokenize(@ref, 'oclc:')[2], ' ')[1]</object>
			 </statement>
            
			 <statement n="432" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'oclc:')][not(ancestor::itei:cit)])))}"><!-- ... where is the citation? -->
				<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-oclc-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
		        <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:title[contains(@ref, 'oclc:')][not(ancestor::itei:cit)])[$repeatIndex]/ancestor::itei:*[@citetrail][1]/@citetrail/string())</object>
			 </statement>
            
             <!-- GND works -->
            
			 <statement n="433" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])))}"><!-- a CitationAct event... -->
    			<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
    			<predicate prefix="rdf">type</predicate>
    			<object type="uri" prefix="cito">citationAct</object>
    		 </statement>
            
			 <statement n="434" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])))}"><!-- ... of type... -->
				<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitationCharacterization</predicate>
				<object type="uri" prefix="cito">citesAsRelated</object>
			 </statement>
            
			 <statement n="435" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])))}"><!-- ... what is cited? -->
				<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitedEntity</predicate>
				<object type="uri" prepend="http://d-nb.info/gnd/">/($currentResource[self::itei:text]//itei:title[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])[$repeatIndex]/tokenize(tokenize(@ref, 'gnd:')[2], ' ')[1]</object>
			 </statement>
            
			 <statement n="436" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])))}"><!-- ... where is the citation? -->
				<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
		        <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:title[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])[$repeatIndex]/ancestor::itei:*[@citetrail][1]/@citetrail/string())</object>
			 </statement>
            
            <!-- b.2. ... to authors (-> CitationAct_d_XY-## blank nodes) -->
            
            <!-- SvSal authors -->
            
            <statement n="437" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'author:')][not(ancestor::itei:cit)])))}"> <!-- cito citationAct -->
            	<subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-authors-', $repeatIndex)</subject>
            	<predicate prefix="rdf">type</predicate>
            	<object type="uri" prefix="cito">citationAct</object>
            </statement>
            
            <statement n="438" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'author:')][not(ancestor::itei:cit)])))}"><!-- ... of type ... -->
            	<subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-authors-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitationCharacterization</predicate>
            	<object type="uri" prefix="cito">citesAsRelated</object>
            </statement>
            
            <statement n="439" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'author:')][not(ancestor::itei:cit)])))}"> <!-- ... what is cited? -->
            	<subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-authors-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitedEntity</predicate>
            	<object type="uri" prepend="authors.">/($currentResource[self::itei:text]//itei:persName[contains(@ref, 'author:')][not(ancestor::itei:cit)])[$repeatIndex]/tokenize(tokenize(@ref, 'author:')[2], ' ')[1]</object>
            </statement>
            
            <statement n="440" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'author:')][not(ancestor::itei:cit)])))}"><!-- ... where is the citation? -->
                <subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-authors-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
                <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:persName[contains(@ref, 'author:')][not(ancestor::itei:cit)])[$repeatIndex]/ancestor::itei:*[@citetrail][1]/@citetrail/string())</object>
            </statement> <!-- choose only p or div as ancestors here? .../ancestor::*[self::itei:p or self::itei:div][1]/... -->
            
            <!-- Cerl authors -->
            
            <statement n="441" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'cerl:')][not(ancestor::itei:cit)])))}"><!-- a CitationAct event... -->
            	<subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-cerl-', $repeatIndex)</subject>
            	<predicate prefix="rdf">type</predicate>
            	<object type="uri" prefix="cito">citationAct</object>
            </statement>
            
            <statement n="442" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'cerl:')][not(ancestor::itei:cit)])))}"><!-- ... of type... -->
            	<subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-cerl-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitationCharacterization</predicate>
            	<object type="uri" prefix="cito">citesAsRelated</object>
            </statement>
            
            <statement n="443" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'cerl:')][not(ancestor::itei:cit)])))}"><!-- ... what is cited? -->
            	<subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-cerl-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitedEntity</predicate>
            	<object type="uri" prepend="http://thesaurus.cerl.org/record/">/($currentResource[self::itei:text]//itei:persName[contains(@ref, 'cerl:')][not(ancestor::itei:cit)])[$repeatIndex]/tokenize(tokenize(@ref, 'cerl:')[2], ' ')[1]</object>
            </statement>
            
            <statement n="444" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'cerl:')][not(ancestor::itei:cit)])))}"><!-- ... where is the citation? -->
            	<subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-cerl-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
                <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:persName[contains(@ref, 'cerl:')][not(ancestor::itei:cit)])[$repeatIndex]/ancestor::itei:*[@citetrail][1]/@citetrail/string())</object>
            </statement> <!-- choose only p or div as ancestors here? .../ancestor::*[self::itei:p or self::itei:div][1]/... -->
            
            <!-- GND authors -->
            
            <statement n="445" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])))}"><!-- a CitationAct event... -->
            	<subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
            	<predicate prefix="rdf">type</predicate>
            	<object type="uri" prefix="cito">citationAct</object>
            </statement>
            
            <statement n="446" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])))}"><!-- ... of type... -->
            	<subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitationCharacterization</predicate>
            	<object type="uri" prefix="cito">citesAsRelated</object>
            </statement>
            
            <statement n="447" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])))}"><!-- ... what is cited? -->
            	<subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitedEntity</predicate>
                <object type="uri" prepend="http://d-nb.info/gnd/">/($currentResource[self::itei:text]//itei:persName[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])[$repeatIndex]/tokenize(tokenize(@ref, 'gnd:')[2], ' ')[1]</object>
            </statement>
            
            <statement n="448" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])))}"><!-- ... where is the citation? -->
            	<subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
                <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:persName[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])[$repeatIndex]/ancestor::itei:*[@citetrail][1]/@citetrail/string())</object>
            </statement> <!-- choose only p or div as ancestors here? .../ancestor::*[self::itei:p or self::itei:div][1]/... -->
            
            <!-- note: if hasCitingEntity only points to p|div ancestors (currently not the case), perhaps we should also include ancestor::itei:item[ancestor::itei:list/@type='dict'] -->
            
            <!-- TODO: viaf? -->
            
            
            <!-- c. References to non-literary entities (places, organizations etc.): We render this with book:mentions -->
            
            <!-- Getty places (independently of whether or not inside a citation) -->
            <statement n="449">
                <subject type="uri" prepend="texts/">/(concat($currentResource[self::itei:text]/@in, if ($currentResource[self::itei:text]/@n) then concat(':vol', $currentResource/@n) else ()))</subject>
                <predicate prefix="book">mentions</predicate>
                <object type="uri" prepend="http://vocab.getty.edu/tgn/">/($currentResource[self::itei:text]//itei:placeName[contains(@ref, 'getty:')])/tokenize(tokenize(@ref, 'getty:')[2], ' ')[1]</object>
            </statement>
            

        </triples>
    </configuration>

    <!-- This is likely to be overwritten by createConfig.xql -->
    <collection>
        <resource uri="{//sal:index}"/>
    </collection>
    
</xtriples>